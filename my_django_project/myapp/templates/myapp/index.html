<html>
    <head>
        <title>
            Excel file upload and processing : Django Example
        </title>
    </head>
    <body style="margin-top: 30px;margin-left: 30px;">
        <form action="{% url "myapp:index" %}" method="POST" enctype="multipart/form-data">
            {% csrf_token %}
            <input type="file"
                   title="Upload excel file"
                   name="excel_file"
                   style="border: 1px solid black; padding: 5px;"
                   >
            <p></p>
            <input type="submit"
                   value="Upload"
                   name="upload"
                   style="border: 1px solid green; padding:5px; border-radius: 2px; cursor: pointer;margin-bottom: 20px;
    display: block;">


            <input type="text" name="search_value" placeholder="Search" style="float: left;border: 1px solid black; width: 250px; height: 30px; ">
            <p></p>
            <button 
            type="search"
            name="search" 
            style=" border: 1px solid green;
                    padding: 5px;
                    border-radius: 2px;
                    cursor: pointer;
                    margin-bottom: 20px;
                    display: block;
                    margin-top: 65px;"> Search </button>

          <button 
            type="clear_selection"
            name="clear" 
            style=" border: 1px solid green;
                    padding: 5px;
                    border-radius: 2px;
                    cursor: pointer;
                    margin-bottom: 20px;
                    display: block;
                    margin-top: 65px;"> clear selection </button>
        </form>

        <hr>
        <table  id="example" class="display" cellspacing="0" width="100%" border="1.5px">
          <tr align="center">
            <th style="font-family: Calibri" > Name </th>
            <th style="font-family: Calibri" > Email ID </th>
            <th style="font-family: Calibri" > Phone Number </th>
            <th style="font-family: Calibri" > Age </th>
        </tr>
        {% for row in excel_data %}
          {% if row.phonenumber %}
            <tr align="center">
              <td style="font-family: Calibri" > {{ row }} </td>
              <td style="font-family: Calibri" > {{ row.email }} </td>
              <td style="font-family: Calibri" > {{ row.phonenumber }} </td>
              <td style="font-family: Calibri" > {{ row.age }} </td>
            </td>
          {% endif %}
        {% endfor %}
        </table>  
    </body>
</html>
